# 说明

* 本工程文件目前并不完善，点击开始转换或exe可执行文件后会出错，具体原因不明，疑似内存不足。
* 如若在测试期间出现错误，可能的解决方案如下
	* 删除/Designer/pic文件夹内的图片文件
	* 结束Powerpoint进程

* 主程序入口文件 /Designer/RunMainWindow.py

# 所需库文件

* PyQt5
* win32com
* pptx
* pydub
* pyaudio
* wave
* contextlib



# 文件功能介绍

## 主文件目录

- AudioGenerator.py

	该文件用于:

	1. 在空白备注页中根据用户设定的停留时长生成空白音频
	2. 将每一页幻灯片的音频合成总音频文件

- NotesExtract.py

	该文件用于将pptx文件中的备注提取成Python列表变量

- VideoGenerator.py

	该文件用于:

	1. 将pptx文件中的每一页幻灯片转换为图片
	2. 将每一页的图片与每一页的音频进行合成，最后输出视频文件

- tts.py

	该文件用于将备注文字转为音频文件

## /Designer目录

- /audio_src

	该文件夹存储了所有可供选择的人声的试听音频

- AudioConfirmWindow

	系统在音频合成完毕后弹出窗口询问用户是否进行试听并进行进一步修改

- BackConfirmWindow

	用户在Edit界面点选返回主界面时弹出窗口确认

- Edit

	该文件用于处理幻灯片，作用如下：

	1. 为有备注的幻灯片进行拼音检查(如果有)
	2. 为无备注的幻灯片进行停留时间的设定

- MainWindow

	主界面，用于完成操作步骤中的1-4

- NoTimeConfirm

	用户将无备注的幻灯片停留时长设为0s时弹出窗口确认(因为0s停留时长意味着该无备注幻灯片不会出现在最后的视频中)

- QuitWindow

	用户完成视频转换后弹出的窗口，可供用户进行下列选择：

	1. 返回主界面
	2. 打开生成的视频
	3. 退出程序

- RunMainWindow

	驱动文件



文件代码功能见各文件注释



# 操作步骤简介

1. 选择pptx源文件

2. 选择音源（这里提供试听功能）

3. 选择生成视频文件的目录

4. 功能选项

- 启用拼音检查

	该功能可以对系统根据备注文字转换的拼音进行修正，修正格式为"拼音字母+声调(1-4)

	**[对于格式错误的修改没有进行异常处理]**

- 仅查看无备注幻灯片

	该功能必须在未选定"启用拼音检查"时才可以选择，对于无备注的页面，用户仍需为其设定在视频中的停留时长

5. Edit页面操作逻辑说明见/Designer/Edit.py中11-20行注释

6. 在设置完空白备注的停留时长和非空白备注的拼音检查(如果有)时，可以通过上一页或下一页切换页面并进行修改，修改界面的上方存有当前页面的预览图，预览图上方显示当前页面的页数，当且仅当处理所有页面后才能点按修改完成

7. 修改完成后系统进行音频转换和视频转换

8. 转换成功后用户可以选择返回主界面、播放视频或直接退出程序。